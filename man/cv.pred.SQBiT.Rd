% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cv.pred.SQBiT.R
\name{cv.pred.SQBiT}
\alias{cv.pred.SQBiT}
\title{k-fold Cross-Validation for SQBiT}
\usage{
cv.pred.SQBiT(
  y,
  C,
  X,
  B,
  Q2,
  P,
  d = 3,
  r = 1,
  lambda,
  nfold = 5,
  initial = 2024,
  tau = 0.5,
  eta.j = 0.32,
  h,
  var.j = FALSE
)
}
\arguments{
\item{y}{A numeric response vector of length \code{n}, where \code{n} is the number of observations.}

\item{C}{A matrix of covariates with constant coefficients, of dimension \code{n} by \code{q}.}

\item{X}{A matrix of covariates with spatially varying coefficients, of dimension \code{n} by \code{p}.}

\item{B}{The B-spline basis matrix of dimension \code{n} by \code{K}, evaluated at spatial coordinates.}

\item{Q2}{A penalty-related matrix generated by the \code{BPST::basis()} function.}

\item{P}{A penalty matrix from the spatial basis representation.}

\item{d}{Degree of piecewise polynomials; default is 3.}

\item{r}{Smoothness parameter; default is 1. Must satisfy \code{0 <= r < d}.}

\item{lambda}{A vector of candidate penalty parameters. Default is typically set to a sequence of log-scaled values.}

\item{nfold}{The number of folds in cross-validation; default is 5. Must be at least 3.}

\item{initial}{A numeric seed used for reproducibility; default is 2024.}

\item{tau}{Quantile level; default is 0.5 (median regression).}

\item{eta.j}{A scalar for adaptive penalty weight; default is 0.32.}

\item{h}{A bandwidth parameter used in model fitting.}

\item{var.j}{Logical. If \code{TRUE}, allows componentwise adaptive weights; default is \code{FALSE}.}
}
\value{
A numeric vector of check loss values, one for each fold.
}
\description{
This function implements k-fold cross-validation for the quantile regression model with spatially varying coefficients, and returns the average check loss across folds.
}
\details{
The function fits the model using \code{SQBiT()} on each training fold, predicts on the held-out set, and evaluates prediction error using the check loss function. The average of these losses estimates the predictive performance at the given \code{tau}.
}
\references{
Kim, M., Wang, L., and Wang, H. J. (2025). Estimation and inference of quantile spatially varying coefficient models over complicated domains. \emph{Journal of the American Statistical Association}, 1--15. Taylor & Francis. Forthcoming.
}
